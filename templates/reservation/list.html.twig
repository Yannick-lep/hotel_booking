{# templates/reservation/list.html.twig #}
{% extends 'base.html.twig' %}

{% block title %}Mes r√©servations{% endblock %}

{% block body %}
<div class="container">
    <h1 class="mb-4">üìã Mes r√©servations</h1>

    {# R√âSERVATIONS √Ä VENIR #}
    <h2 class="mt-4">üîú √Ä venir</h2>
    
    {% if upcomingReservations is not empty %}
        <div class="row">
            {% for reservation in upcomingReservations %}
                <div class="col-md-6 mb-3">
                    <div class="card shadow-sm">
                        <div class="card-header bg-success text-white">
                            <h5 class="mb-0">{{ reservation.service.name }}</h5>
                        </div>
                        <div class="card-body">
                            <p class="mb-2">
                                <strong>üìÖ Date :</strong> 
                                {{ reservation.startAt.format('d/m/Y') }}
                            </p>
                            <p class="mb-2">
                                <strong>üïê Horaire :</strong> 
                                {{ reservation.startAt.format('H:i') }} 
                                ‚Üí 
                                {{ reservation.endAt.format('H:i') }}
                            </p>
                            <p class="mb-2">
                                <strong>‚è±Ô∏è Dur√©e :</strong> 
                                {{ reservation.durationInMinutes }} minutes
                            </p>
                            <p class="mb-0 text-muted small">
                                R√©serv√© le {{ reservation.createdAt.format('d/m/Y √† H:i') }}
                            </p>

                            {# ACTIONS #}
                            <div class="mt-3 d-flex gap-2">
                                {# Bouton MODIFIER #}
                                <a href="{{ path('reservation_edit', {id: reservation.id}) }}" 
                                   class="btn btn-sm btn-warning">
                                    ‚úèÔ∏è Modifier
                                </a>

                                {# Bouton SUPPRIMER (avec confirmation) #}
                                <form method="post" 
                                      action="{{ path('reservation_delete', {id: reservation.id}) }}"
                                      onsubmit="return confirm('√ätes-vous s√ªr de vouloir annuler cette r√©servation ?');"
                                      class="d-inline">
                                    <input type="hidden" name="_token" 
                                           value="{{ csrf_token('delete' ~ reservation.id) }}">
                                    <button type="submit" class="btn btn-sm btn-danger">
                                        üóëÔ∏è Annuler
                                    </button>
                                </form>

                                {# Bouton D√âTAILS #}
                                <a href="{{ path('reservation_show', {id: reservation.id}) }}" 
                                   class="btn btn-sm btn-info">
                                    üëÅÔ∏è D√©tails
                                </a>
                            </div>
                        </div>
                    </div>
                </div>
            {% endfor %}
        </div>
    {% else %}
        <div class="alert alert-info">
            Vous n'avez aucune r√©servation √† venir.
            <a href="{{ path('home') }}" class="alert-link">R√©server maintenant</a>
        </div>
    {% endif %}

    {# R√âSERVATIONS PASS√âES #}
    <h2 class="mt-5"> Historique</h2>
    
    {% if pastReservations is not empty %}
        <div class="row">
            {% for reservation in pastReservations %}
                <div class="col-md-6 mb-3">
                    <div class="card shadow-sm">
                        <div class="card-header bg-secondary text-white">
                            <h5 class="mb-0">{{ reservation.service.name }}</h5>
                        </div>
                        <div class="card-body">
                            <p class="mb-2">
                                <strong> Date :</strong> 
                                {{ reservation.startAt.format('d/m/Y') }}
                            </p>
                            <p class="mb-2">
                                <strong> Horaire :</strong> 
                                {{ reservation.startAt.format('H:i') }} 
                                ‚Üí 
                                {{ reservation.endAt.format('H:i') }}
                            </p>
                            <p class="mb-0">
                                <strong>‚è± Dur√©e :</strong> 
                                {{ reservation.durationInMinutes }} minutes
                            </p>
                        </div>
                    </div>
                </div>
            {% endfor %}
        </div>
    {% else %}
        <div class="alert alert-secondary">
            Aucune r√©servation pass√©e.
        </div>
    {% endif %}

    {# BOUTON RETOUR #}
    <div class="mt-4">
        <a href="{{ path('home') }}" class="btn btn-primary">
            ‚Üê Retour √† l'accueil
        </a>
    </div>
</div>
{% endblock %}